"use strict";!function(){var t=location.search.slice(1).split("&")[0].split("=")[1],e=decodeURI(location.search.slice(1).split("&")[1].split("=")[1]),a=1,c=!0,i=0;$(".sidebar .shop-cart").click(function(){i=c?276:0,c=!c,$(".sidebar").stop().animate({right:i+"px"}),$(".sidebar-spcart").stop().animate({width:i+"px"})}),$.ajax({type:"get",url:"../api/getgoods.php",dataType:"json",data:{gid:t,type:e},success:function(t){if(0==t.code){$(".sort-list span").eq(2).text(t.goods.g_type),$(".sort-list span").eq(4).text(t.goods.g_name),magnifier({el:".magnifier",imgURL:t.goods[0].g_url,width:150,height:150,multiple:2});var e='<li><img src="'+t.goods[0].g_url+'"></li>';$(".img-list").html(e),$(".goods-name").text(t.goods[0].g_name),$(".goods-price .price").text("￥"+t.goods[0].g_price);var a="";t.list.forEach(function(t){a+='<li class="love-goods" data-id="'+t.g_id+'" data-type="'+t.g_type+'">\n                                <img src="'+t.g_url+'" alt="">\n                                <p class="name-text">'+t.g_name+'</p>\n                                <p class="price">￥'+t.g_price+"</p>\n                            </li>"}),$(".loves-list").html(a).on("click","li",function(){window.open("goods.html?gid="+$(this).attr("data-id")+"&gtype="+$(this).attr("data-type"))}),$(".parameter li").eq(0).text("品牌:"+t.goods[0].g_shop),$(".parameter li").eq(1).text("商品:"+t.goods[0].g_name)}}});var n=new GetUser("userid",".log-reg");n.getData();var s=n.getCart();function r(t){var e="",a=0,c=0;return t.orders.forEach(function(t){a+=1*t.count,c+=t.count*t.g_price,e+='<li class="spc-item">\n                        <img src="'+t.g_url+'" alt="">\n                        <p class="spc-name">\n                            '+t.g_name+'\n                        </p>\n                        <p class="spc-operation">\n                            <span class="spc-price">￥'+t.g_price+'</span>\n                            <span class="spc-count"> x '+t.count+'</span>\n                            <a href="javascript:;" class="spc-del">删除</a>\n                        </p>\n                    </li>'}),$(".sidebar-spcart .spcart-list").html(e),$(".cart-count").text(a),$(".sidebar-spcart .pay-count").text("总共"+a+"件"),$(".sidebar-spcart .pay-price").text("￥"+c),{count:a,allprice:c}}function o(e){if(!document.cookie)return null;var t=document.cookie.split("; "),a="";return t.some(function(t){if(-1!=t.indexOf(e))return a=t.split("=")[1],!0}),a}s&&s.then(function(t){r(t)}),$(".count").val(a),$(".add").click(function(){a+=1,$(".count").val(a)}),$(".reduce").click(function(){0<a-1&&(a-=1),$(".count").val(a)}),$(".add-btn").click(function(){o("userid")||(location.href="login.html"),$.ajax({type:"get",url:"../api/addcart.php",dataType:"json",data:{gid:t,uid:o("userid"),count:1*$(".count").val()},success:function(a){0==a.code?n.getCart().then(function(t){var e=r(t);$(".cart-alert .count b").text(e.count),$(".cart-alert .price b").text(e.allprice),$(".cart-alert").show().find(".mesg").text(a.mesg)}):$(".cart-alert").show().find(".mesg").text(a.mesg)}})}),$(".cart-alert .gosele").click(function(){window.open("shopCart.html"),$(".cart-alert").hide()}),$(".cart-alert .continue").click(function(){$(".cart-alert").hide()}),search(".search-input",".search-btn")}();